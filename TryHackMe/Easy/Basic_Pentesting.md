# **Vulnerability Assessment and Penetration Testing (VAPT) Report – Basic Pentesting Machine**  
**Prepared by:** Nishanth Antony  
**Date:** August 6, 2025  
**Difficulty:** Easy  
**Category:** Web Exploitation / Privilege Escalation  
**Platform:** Try Hack Me (THM)

---

### 1. Reconnaissance Steps  
**Objective:** Identify active hosts, open ports, services, and potential vulnerabilities.  
**Commands Used:**  
```bash
- ping <target_ip>  
- nmap -A <target_ip>  
- dirb http://<target_ip>  
- enum4linux <target_ip>
```

**Findings:**  
- Host confirmed online via ping.  
- Open ports: HTTP (80), SSH (22), SMB (445).  
- Apache web server detected with hidden directory `/development`.  
- SMB enumeration revealed users: jan and kay.  
- `/development` exposed files: j.txt (weak password hint for jan) and dev.txt (system details).  

---

### 2. Exploitation Process  
**Step 1 – Web Enumeration (Port 80)**  
- Used `dirb` to find `/development`, containing j.txt and dev.txt.  
- j.txt hinted at jan’s weak password; dev.txt noted Apache, SMB, and Struts 2.5.12.  

**Step 2 – Brute-Forcing SSH (Port 22)**  
- Used hydra to brute-force jan’s SSH credentials:
  ```bash
  hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://<target_ip>
  ```
- Result: Password `armando`.  

**Step 3 – SSH Access as Jan**  
- Logged in via SSH:
  ```bash
  ssh jan@<target_ip>
  ```
  with password `armando`.  
- Found `/home/jan` and `/home/kay`; `/home/kay/pass.bak` was inaccessible.  
- Discovered readable `.ssh/id_rsa` in `/home/kay/.ssh` (misconfigured permissions).  

**Step 4 – SSH Key Analysis**  
- Copied id_rsa:
```bash
  scp jan@<target_ip>:/home/kay/.ssh/id_rsa .
``` 
- Converted key to hash:
```bash
  /usr/share/john/ssh2john.py id_rsa > crack
```
- Cracked passphrase with john:
```bash
  `john crack --wordlist=/usr/share/wordlists/rockyou.txt`
``` 
- Result: Passphrase `beeswax`.  

**Step 5 – Privilege Escalation**  
- Logged in as kay: `ssh -i id_rsa kay@<target_ip>` with passphrase `beeswax`.  
- Accessed `/home/kay/pass.bak`: Contained `heresareallystrongpasswordthatfollowsthepasswordpolicy$$`.  

---

### 3. Proof of Concept (PoC)  
- **SSH Brute Force:**
  ```bash
  hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://<target_ip>
  ```
  Obtained jan:armando.  
- **SSH Key Cracking:**
  ```bash
  john crack --wordlist=/usr/share/wordlists/rockyou.txt
  ```  
  Cracked passphrase `beeswax`.  
- **Privilege Escalation:**  
  Used id_rsa to gain kay’s access and read pass.bak.  

---

### 4. Privilege Escalation  
- Exploited readable id_rsa in `/home/kay/.ssh` with weak passphrase beeswax.  
- Gained access as kay, accessing restricted file pass.bak.  

---

### 5. Mitigation Recommendations  
- **Web Server Hardening:**  
  - Restrict `/development` with authentication (.htaccess or Basic Auth).  
  - Use unpredictable directory names and scan for exposed resources.  
- **Authentication Security:**  
  - Enforce strong passwords (12+ characters, mixed types).  
  - Require unique, complex SSH key passphrases.  
- **File Permission Security:**  
  - Set SSH key permissions to owner-only: `chmod 600 id_rsa`, `chmod 700 .ssh`.  
  - Audit file permissions regularly.  
- **System Hardening:**  
  - Disable unnecessary services (e.g., SMB).  
  - Implement multi-factor authentication for SSH.  
- **Patch Management:**  
  - Update Apache and Struts to the latest versions.  
  - Monitor logs for unauthorized access attempts.  

---

### 6. Lessons Learned  
- **Weak Credentials:** Simple passwords like armando are easily brute-forced.  
- **Exposed Directories:** Unprotected web directories leak sensitive information.  
- **SSH Key Misconfiguration:** Readable private keys with weak passphrases enable privilege escalation.  
- **System Hygiene:** Regular audits and strong permission settings are critical.  

---

### 7. Skills Practiced  
- Network scanning (nmap, ping)  
- Web enumeration (dirb)  
- SMB enumeration (enum4linux)  
- Credential brute-forcing (hydra)  
- SSH key cracking (john, ssh2john.py)  
- File system exploration and privilege escalation  
- Secure reporting and mitigation strategies
